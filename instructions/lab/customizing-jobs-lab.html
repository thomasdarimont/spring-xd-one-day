<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;6.&nbsp;Customizing Jobs</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.70.0"><link rel="start" href="index.html" title="Spring XD - Lab Documentation"><link rel="up" href="index.html" title="Spring XD - Lab Documentation"><link rel="prev" href="introduction-to-jobs-lab.html" title="Chapter&nbsp;5.&nbsp;Introduction to Jobs"><link rel="next" href="advanced-jobs-lab.html" title="Chapter&nbsp;7.&nbsp;Advanced Jobs"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.pivotal.io" title="Pivotal"><img style="border:none;" src="images/heading-logo-lhs.jpg"></img></a><a style="border:none;" href="http://www.spring.io" title="The Spring Framework"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/heading-logo-rhs.jpg"></img></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="customizing-jobs-lab"></a>Chapter&nbsp;6.&nbsp;Customizing Jobs</h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="customizing-jobs-lab-objective"></a>6.1.&nbsp;Objective</h2></div></div></div><p>To create and install a custom Spring XD job.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="customizing-jobs-lab-tasklet"></a>6.2.&nbsp;Creating a Custom Spring XD Job</h2></div></div></div><p>In order to create a custom Spring XD job, it is necessary to create a tasklet, create a custom context XML file, build and
			  package it into a single jar file, then install it into the module registry.  It is then available to be deployed as a new
			  job.</p><div class="orderedlist"><ol type="1" compact><li><p>Take a look at the <code class="code">HelloSpringXDTasklet.java</code> source code in the <code class="code">batch-simple</code> project.
					  Note that it implements the Tasklet and StepExecutionListener interfaces.  Also, examine how the job parameters are
					  extracted for use.  The code essentially just iterates over all the parameters passed in, and logs them to the console.</p><p>Open the <code class="code">spring-module.xml</code> context configuration file, found in the <code class="code">src/main/resources/config</code> subdirectory.
					  Note how the tasklet in the job steps reference the bean, which is an instance of the custom HelloSpringXDTasklet class.</p><p>Change to the <code class="code">springxd-batch-simple</code> lab project directory, and execute</p><pre class="programlisting">mvn clean package</pre><p>Verify the project built successfully by checking the <code class="code">jar</code> file was created in the 
					  <code class="code">target</code> subdirectory.</p></li><li><p>Launch the XD shell, and use the <code class="code">module upload</code> command to upload the module into the custom repository.
					  Verify the module was successfully uploaded by finding it in the output of the <code class="code">module list</code>.
					  Also take a look at the contents of the custom modules directory, and see that the jar file
					  has been copied there.</p></li><li><p>From the XD shell, create the job using the custom module as the definition.  Verify by listing the jobs using the shell, or
					  opening the administration UI web-page.  Go ahead and deploy the job.</p></li><li><p>Launch the job, and specify some parameters for it.  Any number of parameters can be added to the job - this would actually
					  depend on the exact implementation of your tasklet.  Experiment with different numbers and types of parameters.
					  Specify a parameter "throwError", if it is set to "true" then the tasklet will succeed every 4th execution, otherwise it
					  will throw an exception.  Observe the output of the Spring XD server log.</p><pre class="programlisting">xd:&gt;job launch helloSpringXD --params '{"throwError":"true"}'
Successfully submitted launch request for job 'helloSpringXD'
xd:&gt;</pre></li></ol></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="introduction-to-jobs-lab.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="advanced-jobs-lab.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;5.&nbsp;Introduction to Jobs&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.spring.io" title="The Spring Framework">Spring By Pivotal</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;7.&nbsp;Advanced Jobs</td></tr></table></div></body></html>